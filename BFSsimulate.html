<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>BFS(Breadth-first search)</title>
		<style>
		
		canvas{
			border: solid 1px green;
		}
		
	</style>
		
	</head>
	
	<body>
		
		<table>
			<tr>
				<td>
					
					<form name = "BFSForm" id="BFSForm" >
						<table>
						<tr>
							<td><p>1.設定模式:</p></td>  <td><input type="radio" name="modeChoice1" value="模擬模式" onClick = "modeChoice();">模擬模式</td>  <td><input type="radio" name="modeChoice1" value="測驗模式" onClick = "modeChoice();">測驗模式   </td>
							<td><input type = "button"  value = "清除" onClick = "modeClear();"></td><td><p id="mode"></p></td>

						</tr>
						<tr>
							<td><p>2.設定圖形模式</p></td>  <td><input type="radio" name="graph1" value="undirected graph" onClick = "graphChoice();">undirected graph</td>  <td><input type="radio" name="graph1" value="directed graph" onClick = "graphChoice();">directed graph   </td>
							<td><input type = "button"  value = "清除" onClick = "graphClear();"></td><td><p id="graph"></p></td>
						</tr>
						</table>

						<table>
							<tr>
								<td>3.輸入資料：</td>
							</tr>
						</table>
						<table>
							<tr>
								<td></td>
								<td><p>0</p></td>
								<td><p>1</p></td>
								<td><p>2</p></td>
								<td><p>3</p></td>
								<td><p>4</p></td>
								<td rowspan = "7"><canvas id = "myGraph" width = 280 height = 280>Your browser does not support</canvas></td>
							</tr>
							<tr>
								<td><p>0</p></td>
								<td><input type=text value="0" id=0 size="5" readonly="readonly"></td>
								<td><input type=text value="" id=1 size="5"></td>
								<td><input type=text value="" id=2 size="5"></td>
								<td><input type=text value="" id=3 size="5"></td>
								<td><input type=text value="" id=4 size="5"></td>
								<td></td>
							</tr>
							<tr>
								<td><p>1</p></td>
								<td><input type=text value="" id=5 size="5"></td>
								<td><input type=text value="0" id=6 size="5" readonly="readonly"></td>
								<td><input type=text value="" id=7 size="5"></td>
								<td><input type=text value="" id=8 size="5"></td>
								<td><input type=text value="" id=9 size="5"></td>
								<td></td>
							</tr>
							<tr>
								<td><p>2</p></td>
								<td><input type=text value="" id=10 size="5"></td>
								<td><input type=text value="" id=11 size="5"></td>
								<td><input type=text value="0" id=12 size="5" readonly="readonly"></td>
								<td><input type=text value="" id=13 size="5"></td>
								<td><input type=text value="" id=14 size="5"></td>
								<td></td>
							</tr>
							<tr>
								<td><p>3</p></td>
								<td><input type=text value="" id=15 size="5"></td>
								<td><input type=text value="" id=16 size="5"></td>
								<td><input type=text value="" id=17 size="5"></td>
								<td><input type=text value="0" id=18 size="5" readonly="readonly"></td>
								<td><input type=text value="" id=19 size="5"></td>
								<td></td>
							</tr>
							<tr>
								<td><p>4</p></td>
								<td><input type=text value="" id=20 size="5"></td>
								<td><input type=text value="" id=21 size="5"></td>
								<td><input type=text value="" id=22 size="5"></td>
								<td><input type=text value="" id=23 size="5"></td>
								<td><input type=text value="0" id=24 size="5" readonly="readonly"></td>
								<td></td>
							</tr>
						</table>
						<table>
							<tr>
								<td><input type = "button"  value = "輸入完成" onClick = "decideAdjMatrix();"></td> 
								<td><input type = "button"  value = "隨機產生" onClick = "randomGenerateAdjMatrix();"></td>
								<td><input type = "button"  value = "清除" onClick = "clearAdjMatrix();"></td> 
							</tr>
						</table>
						<table>
							<tr>
								<td><p id="state"></p></td>
							</tr>
							
						</table>
						<table>
							<tr>
								<td><p>4.現在步驟：</p><textarea name="Content" style="width:550px;height:100px;" id=hashTableArea readonly="readonly"></textarea></td>
							</tr>
						</table>
						<table>
							<tr>
								<td><input type = "button"  value = "下一步" onClick = "next();"></td> 
								<td><input type = "button"  value = "一次做完" onClick = "doAll();"></td>
								<td><input type = "button"  value = "全部清除" onClick = "clearAll();"></td> 
							</tr>
						</table>
					</form>
				</td>

				<td>
					
				</td>
			</tr>
		</table>
		

		<script>
			var mode = -1; // 0 is simulate mode  , 1 is test mode
			var graph = -1; // 0 is undirected graph , 1 is directed graph
			var BFSstep = 0; // control the BFS step for the next button use.
			var wrongInput = 0;
			var adjMatrix = []; // A two dimision array adjMatrix represent the graph.
			adjMatrix[0] = [0,0,0,0,0];
			adjMatrix[1] = [0,0,0,0,0];
			adjMatrix[2] = [0,0,0,0,0];
			adjMatrix[3] = [0,0,0,0,0];
			adjMatrix[4] = [0,0,0,0,0];

			var circleDiscover = new Array(0,0,0,0,0);// record the circle wether is discovered.
			
			function modeChoice(){
				var form = document.getElementById("BFSForm");
				var result = document.getElementById("mode");
				clearAdjMatrix();
			
				for (var i = 0; i < form.modeChoice1.length; i++) {
					if ( form.modeChoice1[i].checked ) {
						result.innerHTML = "you selected " + form.modeChoice1[i].value;
						mode = i;
						break;
					}
				}
			}
			
			function graphChoice(){
				var form = document.getElementById("BFSForm");
				var result = document.getElementById("graph");
				clearAdjMatrix();
				
				for (var i = 0; i < form.graph1.length; i++) {
					if ( form.graph1[i].checked ) {
						graph = i;
						result.innerHTML = form.graph1[i].value;
						break;
					}
				}
			}
			
			function modeClear(){
				var form = document.getElementById("BFSForm");
				var result = document.getElementById("mode");
				for (var i = 0; i < form.modeChoice1.length; i++) {
					form.modeChoice1[i].checked = false;
				}
				result.innerHTML = "";
				mode = -1;
			}
			
			function graphClear(){
				var form = document.getElementById("BFSForm");
				var result = document.getElementById("graph");
				for (var i = 0; i < form.graph1.length; i++) {
					form.graph1[i].checked = false;
				}
				result.innerHTML = "";
				graph = -1;
			}

			function decideAdjMatrix(){
				clearGraph();
				var count = 0;
				wrongInput = 0;
				document.getElementById("state").innerHTML = "";
				if(mode == 0 || mode == 1){ // simulate and test
					if(graph == 0){ // undirected graph
						for(var i = 0; i < 3; i++){
							for(var j = 0; j < adjMatrix[i].length; j++){
								if(i == j){
									count = count + 1;
									continue; // for adj Matrix when i == j must 0
								}else{
									var input = document.getElementById(count);
									var userInput = eval(input.value);
									if(userInput != 0 && userInput != 1){
										wrongInput = 1;
									}
									adjMatrix[i][j] = userInput;
									count = count + 1;
								}
							}
						}

						for(var i = 3; i < 5; i++){
							for(var j = 0; j < adjMatrix[i].length; j++){
								if(i == j){
									count = count + 1;
									continue; // for adj Matrix when i == j must 0
								}else{
									var input = document.getElementById(count);
									var userInput = eval(input.value);
									if(userInput != 0 && userInput != 1){
										wrongInput = 1;
									}
									adjMatrix[i][j] = userInput;
									count = count + 1;
								}
							}
						}

						count = 0;
						for(var i = 0; i < 5; i++){
							for(var j = 0; j < adjMatrix[i].length; j++){
								if(i == j){
									count = count + 1;
									continue; // for adj Matrix when i == j must 0
								}else{
									if(adjMatrix[i][j] != adjMatrix[j][i]){ // undirected graph is a symmetric matrix.
										wrongInput = 1;
									}
									
									count = count + 1;
								}
							}
						}

						if(wrongInput == 1){
							clearAdjMatrix(); // User Input the wrong data.
							document.getElementById("state").innerHTML = "你輸入的資料不正確";
						}else{
							drawGraph();
						}
					}else if(graph == 1){
						for(var i = 0; i < 5; i++){
							for(var j = 0; j < adjMatrix[i].length; j++){
								if(i == j){
									count = count + 1;
									continue; // for adj Matrix when i == j must 0
								}else{
									var input = document.getElementById(count);
									var userInput = eval(input.value);
									if(userInput != 0 && userInput != 1){
										wrongInput = 1;
									}
									adjMatrix[i][j] = userInput;
									count = count + 1;
								}
							}
						}
						if(wrongInput == 1){
							clearAdjMatrix(); // User Input the wrong data.
							document.getElementById("state").innerHTML = "你輸入的資料不正確";
						}else{
							drawGraph();
						}
					}else{

					}
				}else{

				}
			}

			function randomGenerateAdjMatrix(){
				clearGraph();
				var count = 0;
				document.getElementById("state").innerHTML = "";
				if(mode == 0 || mode == 1){ // simulate and test
					if(graph == 0){ // undirected graph
						for(var i = 0; i < 5; i++){
							for(var j = i; j < 5; j++){
								if(i == j){
									count = count + 1;
									continue; // for adj Matrix when i == j must 0
								}else{
									var n1 = Math.floor(Math.random()*2);
									var input = document.getElementById(count);
									input.value = n1;
									adjMatrix[i][j] = n1;
									count = count + 1;
								}
							}
							count = count + i + 1;
						}

						count = 5;
						for(var i = 1; i < 5; i++){
							for(var j = 0; j < i; j++){
								if(i == j){
									count = count + 1;
									continue; // for adj Matrix when i == j must 0
								}else{
									var input = document.getElementById(count);
									input.value = adjMatrix[j][i];
									adjMatrix[i][j] = adjMatrix[j][i];
									count = count + 1;
								}
							}
							count = count + (5 - i);
						}
					}else if(graph == 1){
						for(var i = 0; i < 5; i++){
							for(var j = 0; j < adjMatrix[i].length; j++){
								if(i == j){
									count = count + 1;
									continue; // for adj Matrix when i == j must 0
								}else{
									var n1 = Math.floor(Math.random()*2);
									var input = document.getElementById(count);
									input.value = n1;
									adjMatrix[i][j] = n1;
									count = count + 1;
								}
							}
						}
					}else{

					}
					drawGraph();
				}else{

				}
			}// end function randomGenerateAdjMatrix()

			function clearAdjMatrix(){
				
				
				var count = 0;
				for(var i = 0; i < 5; i++){
					for(var j = 0; j < adjMatrix[i].length; j++){
						if(i == j){
							count = count + 1;
							continue; // for adj Matrix when i == j must 0
						}else{
							
							var input = document.getElementById(count);
							input.value = "";
							adjMatrix[i][j] = 0;
							count = count + 1;
						}
					}
				}
				document.getElementById("0").value = 0;
				document.getElementById("6").value = 0;
				document.getElementById("12").value = 0;
				document.getElementById("18").value = 0;
				document.getElementById("24").value = 0;
				

				clearGraph();


			}

			function drawGraph(){
				var canvas = document.getElementById("myGraph");
				var ctx = canvas.getContext("2d");

				if(circleDiscover[0] == 0){
					ctx.beginPath();
					ctx.arc(60,40,30,0,2 * 3.14); // the 0 circle
					ctx.stroke();
				}else if(circleDiscover[0] == 1){
					ctx.beginPath();
					ctx.arc(60,40,30,0,2 * 3.14); // the 0 circle
					ctx.strokeStyle = "red";
					ctx.stroke();
					ctx.strokeStyle = "black";
				}else if(circleDiscover[0] == 2){
					ctx.beginPath();
					ctx.arc(60,40,30,0,2 * 3.14); // the 0 circle
					ctx.fillStyle = "blue";
					ctx.fill();
				}else{

				}

				if(circleDiscover[1] == 0){
					ctx.beginPath();
					ctx.arc(220,40,30,0,2 * 3.14); // the 1 circle
					ctx.stroke();
				}else if(circleDiscover[1] == 1){
					ctx.beginPath();
					ctx.arc(220,40,30,0,2 * 3.14); // the 1 circle
					ctx.strokeStyle = "red";
					ctx.stroke();
					ctx.strokeStyle = "black";
				}else if(circleDiscover[1] == 2){
					ctx.beginPath();
					ctx.arc(220,40,30,0,2 * 3.14); // the 1 circle
					ctx.fillStyle = "blue";
					ctx.fill();
				}else{
					
				}

				if(circleDiscover[2] == 0){
					ctx.beginPath();
					ctx.arc(60,150,30,0,2 * 3.14); // the 2 circle
					ctx.stroke();
				}else if(circleDiscover[2] == 1){
					ctx.beginPath();
					ctx.arc(60,150,30,0,2 * 3.14); // the 2 circle
					ctx.strokeStyle = "red";
					ctx.stroke();
					ctx.strokeStyle = "black";
				}else if(circleDiscover[2] == 2){
					ctx.beginPath();
					ctx.arc(60,150,30,0,2 * 3.14); // the 2 circle
					ctx.fillStyle = "blue";
					ctx.fill();
				}else{
					
				}

				if(circleDiscover[3] == 0){
					ctx.beginPath();
					ctx.arc(220,150,30,0,2 * 3.14); // the 3 circle
					ctx.stroke();
				}else if(circleDiscover[3] == 1){
					ctx.beginPath();
					ctx.arc(220,150,30,0,2 * 3.14); // the 3 circle
					ctx.strokeStyle = "red";
					ctx.stroke();
					ctx.strokeStyle = "black";
				}else if(circleDiscover[3] == 2){
					ctx.beginPath();
					ctx.arc(220,150,30,0,2 * 3.14); // the 3 circle
					ctx.fillStyle = "blue";
					ctx.fill();
				}else{
					
				}

				if(circleDiscover[4] == 0){
					ctx.beginPath();
					ctx.arc(140,240,30,0,2 * 3.14); // the 4 circle
					ctx.stroke();
				}else if(circleDiscover[4] == 1){
					ctx.beginPath();
					ctx.arc(140,240,30,0,2 * 3.14); // the 4 circle
					ctx.strokeStyle = "red";
					ctx.stroke();
					ctx.strokeStyle = "black";
				}else if(circleDiscover[4] == 2){
					ctx.beginPath();
					ctx.arc(140,240,30,0,2 * 3.14); // the 4 circle
					ctx.fillStyle = "blue";
					ctx.fill();
				}else{
					
				}



				
				ctx.fillText("0",20,20); // write the circle number.
				ctx.fillText("1",260,20);
				ctx.fillText("2",20,130);
				ctx.fillText("3",260,130);
				ctx.fillText("4",180,260);

				if(graph == 0){
					if(adjMatrix[0][1] == 1){ // circle 0 to 1
						ctx.beginPath();
						ctx.moveTo(90,40);
						ctx.lineTo(190,40);
						ctx.stroke();
					}

					if(adjMatrix[0][2] == 1){ // circle 0 to 2
						ctx.beginPath();
						ctx.moveTo(60,70);
						ctx.lineTo(60,120);
						ctx.stroke();
					}

					if(adjMatrix[0][3] == 1){ // circle 0 to 3
						ctx.beginPath();
						ctx.moveTo(80,60);
						ctx.lineTo(198,132);
						ctx.stroke();
					}

					if(adjMatrix[0][4] == 1){ // circle 0 to 4
						ctx.beginPath();
						ctx.moveTo(80,60);
						ctx.lineTo(140,210);
						ctx.stroke();
					}


					if(adjMatrix[1][2] == 1){ // circle 1 to 2
						ctx.beginPath();
						ctx.moveTo(205,63);
						ctx.lineTo(87,135);
						ctx.stroke();
					}

					if(adjMatrix[1][3] == 1){ // circle 1 to 3
						ctx.beginPath();
						ctx.moveTo(220,70);
						ctx.lineTo(220,120);
						ctx.stroke();
					}

					if(adjMatrix[1][4] == 1){ // circle 1 to 4
						ctx.beginPath();
						ctx.moveTo(205,63);
						ctx.lineTo(140,210);
						ctx.stroke();
					}

					if(adjMatrix[2][3] == 1){ // circle 2 to 3
						ctx.beginPath();
						ctx.moveTo(90,150);
						ctx.lineTo(190,150);
						ctx.stroke();
					}

					if(adjMatrix[2][4] == 1){ // circle 2 to 4
						ctx.beginPath();
						ctx.moveTo(80,170);
						ctx.lineTo(140,210);
						ctx.stroke();
					}

					if(adjMatrix[3][4] == 1){ // circle 3 to 4
						ctx.beginPath();
						ctx.moveTo(205,175);
						ctx.lineTo(158,215);
						ctx.stroke();
					}



					
				}else{

				}

			}

			function clearGraph(){
				var canvas = document.getElementById("myGraph");
				var ctx = canvas.getContext("2d");
				ctx.clearRect(0,0,canvas.width,canvas.height);
			}

		</script>

	</body>
